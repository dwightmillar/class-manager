"use strict";(self.webpackChunkclass_manager=self.webpackChunkclass_manager||[]).push([[357],{694:(e,t,s)=>{s.r(t),s.d(t,{default:()=>a});var n=s(466);function a(e){let{subject:t,deleteSubject:s,goBack:a}=e;return n.createElement("div",{style:{display:"inline-block"},className:"modal",tabIndex:"-1",role:"dialog"},n.createElement("div",{className:"modal-dialog",role:"document"},n.createElement("div",{className:"modal-content"},n.createElement("div",{className:"modal-header"},n.createElement("h5",{className:"modal-title"},"Deleting ",t)),n.createElement("div",{className:"modal-body"},n.createElement("p",null,"Deleting this will ",n.createElement("b",null,"permanently")," delete ",n.createElement("b",null,"all")," associated data.",n.createElement("br",null),"Are you sure you want to delete?")),n.createElement("div",{className:"modal-footer"},n.createElement("button",{autoFocus:!0,type:"button",className:"btn btn-secondary","data-dismiss":"modal",onClick:a},"Back"),n.createElement("button",{type:"button",className:"btn btn-danger",onClick:()=>{s(),a()}},"Delete")))))}},357:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var n=s(123),a=s(466),l=s(387),r=s(374),d=s(694),i=s(429);function c(e){let{match:t,disabled:s}=e;return s?a.createElement(i.rU,{to:t.url+"/assignment",className:"dropdown-item"},"Add Assignment"):a.createElement("a",{className:"dropdown-item disabled"},"Add Assignment")}function o({numberOfAssignments:e,view:t,toggleView:s}){if(0==e)return a.createElement("button",{className:"dropdown-item disabled"},"View Assignments");let n="assignments"===t?"View Students":"View Assignments";return a.createElement("button",{className:"dropdown-item",onClick:s},n)}function u({showModal:e}){return a.createElement("button",{style:{color:"crimson"},className:"dropdown-item btn",onClick:e},"Delete Class")}function m(e){let{view:t,title:s,classId:l,assignmentAverages:i,classAverage:m,students:g,toggleView:v,toggleModal:E,setClasses:f}=e,A=a.createElement(d.default,{subject:"class",deleteSubject:()=>r.Z.class.delete(l).then((()=>f({data:{id:l}}))).catch((e=>console.error(e))),goBack:()=>E()}),b=g.length,p=Object.keys(i).length,h="assignments"===t?"No. of Assignments: ".concat(p):"Class Size: ".concat(b);return a.createElement("header",{className:"container-fluid"},a.createElement("div",{style:{display:"inline-block",height:"40px"}}),a.createElement("div",{style:{textAlign:"center"}},a.createElement("div",{className:"btn-group dropend"},a.createElement("button",{style:{fontSize:"3rem"},type:"button",className:"btn dropdown-toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},s),a.createElement("ul",{className:"dropdown-menu"},a.createElement("li",null,a.createElement(o,{view:t,numberOfAssignments:p,toggleView:v})),a.createElement("li",null,a.createElement(c,(0,n.Z)({},e,{disabled:Boolean(g.length)}))),a.createElement("li",null,a.createElement("hr",{className:"dropdown-divider"})),a.createElement("li",null,a.createElement(u,{showModal:()=>{E(A)}})))),a.createElement("h2",null,h),a.createElement("h3",{style:{color:"#777"}},"Average Grade: ",m)))}const g=(0,a.lazy)((()=>s.e(163).then(s.bind(s,163)))),v=(0,a.lazy)((()=>s.e(239).then(s.bind(s,239)))),E=(0,a.lazy)((()=>s.e(455).then(s.bind(s,455)))),f=(0,a.lazy)((()=>s.e(584).then(s.bind(s,584)))),A=(0,a.lazy)((()=>s.e(850).then(s.bind(s,850))));function b(e){let{match:t,title:s,toggleModal:d,setClasses:i}=e;const[c,o]=(0,a.useState)({mounted:!1,view:"students",students:[],studentAverages:{},assignments:[],assignmentAverages:{},classAverage:"Calculating..."}),u=t.params.classId;if(null===s&&(s="Loading..."),(0,a.useEffect)((()=>{c.mounted||o({...c,mounted:!0})}),[c.mounted]),(0,a.useEffect)((()=>{c.mounted&&" "!==u&&r.Z.student.load(u).then((({data:e})=>{o({...c,view:"students",students:e,classAverage:e.length?"Calculating...":"N/A"})})).catch((e=>console.error(e)))}),[u,c.mounted]),(0,a.useEffect)((()=>{c.students.length&&b()}),[c.students]),(0,a.useEffect)((()=>{c.assignments.length&&function(){let e={},t=[...c.assignments];c.students.forEach((s=>{let n=0,a=0;t=t.filter((e=>e.student_id!=s.id||(isNaN(e.score)||(n+=parseInt(e.score)),a+=parseInt(e.totalpoints),!1)));let l=0!==a?(n/a*100).toFixed(2):"N/A";e[s.id]=l})),o({...c,studentAverages:e})}()}),[c.assignments]),(0,a.useEffect)((()=>{Object.keys(c.studentAverages).length&&function(){var e=0,t=0;for(let s in c.studentAverages)"N/A"!==c.studentAverages[s]&&(e+=parseFloat(c.studentAverages[s]),++t);if(t){if(isNaN(e/t))return!1}else e="N/A";e=(e/t).toFixed(2)+"%",o({...c,classAverage:e})}()}),[c.studentAverages]),(0,a.useEffect)((()=>{"Calculating..."!==c.classAverage&&function(){let e={};c.assignments.forEach((t=>{e[t.title]=!0})),Object.keys(e).forEach((t=>{let s=c.assignments.filter((e=>e.title===t)),n=0,a=0;s.forEach((e=>{n+=parseInt(e.totalpoints),a+=parseInt(e.score)})),e[t]=(a/n*100).toFixed(2)+"%"})),o({...c,assignmentAverages:e})}()}),[c.classAverage]),void 0===s)return a.createElement(A,null);function b(){r.Z.assignment.load(u).then((({data:e})=>{o({...c,assignments:e,classAverage:e.length?"Calculating...":"N/A"})})).catch((e=>console.error(e)))}function p(){let e=[...c.students],t=JSON.stringify({students:e});e.sort(((e,t)=>e.name.toLowerCase()>t.name.toLowerCase())),t===JSON.stringify({students:e})&&e.sort(((e,t)=>e.name.toLowerCase()<t.name.toLowerCase())),o({...c,students:e})}function h(){let e=[...c.students],t=JSON.stringify({students:e});e.sort(((e,t)=>!isNaN(parseFloat(c.studentAverages[e.id]))&&(!!isNaN(parseFloat(c.studentAverages[t.id]))||parseFloat(c.studentAverages[e.id])>parseFloat(c.studentAverages[t.id])))),t===JSON.stringify({students:e})&&e.sort(((e,t)=>!isNaN(parseFloat(c.studentAverages[t.id]))&&(!!isNaN(parseFloat(c.studentAverages[e.id]))||parseFloat(c.studentAverages[e.id])<parseFloat(c.studentAverages[t.id])))),o({...c,students:e})}function N(){if("assignments"===c.view)return o({...c,view:"students"});o({...c,view:"assignments"})}function w(e){const t=c.students.filter((t=>t.id!==e));o({...c,students:t})}function y(e,t){const s={id:e.insertId,name:t},n=[...c.students];n.push(s),o({...c,students:n})}return a.createElement(l.rs,null,a.createElement(l.AW,{exact:!0,path:"/".concat(u),render:e=>a.createElement(a.Fragment,null,a.createElement(m,(0,n.Z)({},e,{view:c.view,title:s,classId:u,assignmentAverages:c.assignmentAverages,classAverage:c.classAverage,students:c.students,setClasses:i,toggleView:N,toggleModal:d})),"students"===c.view?a.createElement(a.Suspense,{fallback:a.createElement("div",null,"Loading...")},a.createElement(g,(0,n.Z)({},e,{classId:u,students:c.students,assignments:c.assignments,averages:c.studentAverages,toggleModal:d,addStudentCallback:y,deleteStudentCallback:w,sort:{sortByName:p,sortByGrade:h}}))):a.createElement(a.Suspense,{fallback:a.createElement("div",null,"Loading...")},a.createElement(v,(0,n.Z)({},e,{assignments:c.assignments,averages:c.assignmentAverages}))))}),a.createElement(l.AW,{exact:!0,path:"/".concat(u,"/assignment"),render:e=>a.createElement(a.Suspense,{fallback:a.createElement("div",null,"Loading...")},a.createElement(f,(0,n.Z)({},e,{assignments:c.assignments,loadAssignments:b,students:c.students,studentAverages:c.studentAverages,classAverage:c.classAverage,classId:u,title:s})))}),a.createElement(l.AW,{path:"/".concat(u,"/:studentId"),render:e=>a.createElement(a.Suspense,{fallback:a.createElement("div",null,"Loading...")},a.createElement(E,(0,n.Z)({},e,{students:c.students,classId:u,title:s,loadAssignments:b,studentAverage:c.studentAverages[e.match.params.studentId],assignments:c.assignments.filter((t=>t.student_id==e.match.params.studentId))})))}))}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFnQjNELEVBQU1ZLE1BQU1pRCxPQUFPdUMsV0FBWXhDLFlBQWFMLEVBQU1LLFlBQVlRLFFBQU9DLEdBQWNBLEVBQVdDLFlBQWN0RSxFQUFNWSxNQUFNaUQsT0FBT3VDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2xhc3MtbWFuYWdlci8uL3NyYy9jb21wb25lbnRzL01vZGFsLmpzeCIsIndlYnBhY2s6Ly9jbGFzcy1tYW5hZ2VyLy4vc3JjL3ZpZXdzL2NsYXNzL2hlYWRlci9idXR0b25zL0FkZEFzc2lnbm1lbnQuanN4Iiwid2VicGFjazovL2NsYXNzLW1hbmFnZXIvLi9zcmMvdmlld3MvY2xhc3MvaGVhZGVyL2J1dHRvbnMvVG9nZ2xlQ2xhc3NWaWV3LmpzeCIsIndlYnBhY2s6Ly9jbGFzcy1tYW5hZ2VyLy4vc3JjL3ZpZXdzL2NsYXNzL2hlYWRlci9idXR0b25zL0RlbGV0ZUNsYXNzLmpzeCIsIndlYnBhY2s6Ly9jbGFzcy1tYW5hZ2VyLy4vc3JjL3ZpZXdzL2NsYXNzL2hlYWRlci9pbmRleC5qc3giLCJ3ZWJwYWNrOi8vY2xhc3MtbWFuYWdlci8uL3NyYy92aWV3cy9jbGFzcy9pbmRleC5qc3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihwcm9wcykge1xuICBsZXQgeyBzdWJqZWN0LCBkZWxldGVTdWJqZWN0LCBnb0JhY2sgfSA9IHByb3BzXG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IHN0eWxlPXt7ZGlzcGxheTogXCJpbmxpbmUtYmxvY2tcIn19IGNsYXNzTmFtZT1cIm1vZGFsXCIgdGFiSW5kZXg9XCItMVwiIHJvbGU9XCJkaWFsb2dcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtZGlhbG9nXCIgcm9sZT1cImRvY3VtZW50XCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtY29udGVudFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtaGVhZGVyXCI+XG4gICAgICAgICAgICA8aDUgY2xhc3NOYW1lPVwibW9kYWwtdGl0bGVcIj5EZWxldGluZyB7c3ViamVjdH08L2g1PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtYm9keVwiPlxuICAgICAgICAgICAgPHA+RGVsZXRpbmcgdGhpcyB3aWxsIDxiPnBlcm1hbmVudGx5PC9iPiBkZWxldGUgPGI+YWxsPC9iPiBhc3NvY2lhdGVkIGRhdGEuPGJyLz5BcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlPzwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLWZvb3RlclwiPlxuICAgICAgICAgICAgPGJ1dHRvbiBhdXRvRm9jdXMgdHlwZT1cImJ1dHRvblwiIGNsYXNzTmFtZT1cImJ0biBidG4tc2Vjb25kYXJ5XCIgZGF0YS1kaXNtaXNzPVwibW9kYWxcIiBvbkNsaWNrPXtnb0JhY2t9PkJhY2s8L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzTmFtZT1cImJ0biBidG4tZGFuZ2VyXCIgb25DbGljaz17KCk9PiB7ZGVsZXRlU3ViamVjdCgpO2dvQmFjaygpfX0+RGVsZXRlPC9idXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIClcbn0iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyBCcm93c2VyUm91dGVyIGFzIFJvdXRlciwgUm91dGUsIExpbmssIFN3aXRjaCB9IGZyb20gXCJyZWFjdC1yb3V0ZXItZG9tXCJcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24ocHJvcHMpXG57XG4gIGxldCB7bWF0Y2gsIGRpc2FibGVkfSA9IHByb3BzXG4gIGlmICghZGlzYWJsZWQpIHJldHVybiA8YSBjbGFzc05hbWU9XCJkcm9wZG93bi1pdGVtIGRpc2FibGVkXCI+QWRkIEFzc2lnbm1lbnQ8L2E+XG4gIHJldHVybiA8TGluayB0bz17bWF0Y2gudXJsICsgXCIvYXNzaWdubWVudFwifSBjbGFzc05hbWU9XCJkcm9wZG93bi1pdGVtXCI+QWRkIEFzc2lnbm1lbnQ8L0xpbms+XG59IiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih7bnVtYmVyT2ZBc3NpZ25tZW50cywgdmlldywgdG9nZ2xlVmlldyB9KVxue1xuICAgIGlmIChudW1iZXJPZkFzc2lnbm1lbnRzID09IDApXG4gICAgcmV0dXJuIDxidXR0b24gY2xhc3NOYW1lPVwiZHJvcGRvd24taXRlbSBkaXNhYmxlZFwiPlZpZXcgQXNzaWdubWVudHM8L2J1dHRvbj5cblxuICAgIGxldCB0ZXh0ID0gdmlldyA9PT0gJ2Fzc2lnbm1lbnRzJyA/IFwiVmlldyBTdHVkZW50c1wiIDogXCJWaWV3IEFzc2lnbm1lbnRzXCJcbiAgICByZXR1cm4gPGJ1dHRvbiBjbGFzc05hbWU9XCJkcm9wZG93bi1pdGVtXCIgb25DbGljaz17dG9nZ2xlVmlld30+XG4gICAgICAgICAgICAgICAge3RleHR9XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICBcbn0iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHtzaG93TW9kYWx9KVxue1xuICAgIHJldHVybiAoXG4gICAgICAgIDxidXR0b24gc3R5bGU9e3tjb2xvcjogJ2NyaW1zb24nfX0gY2xhc3NOYW1lPVwiZHJvcGRvd24taXRlbSBidG5cIiBvbkNsaWNrPXtzaG93TW9kYWx9PkRlbGV0ZSBDbGFzczwvYnV0dG9uPlxuICAgIClcbn0iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgY29udHJvbGxlciBmcm9tICcuLi8uLi8uLi9jb250cm9sbGVyLmpzJ1xuaW1wb3J0IE1vZGFsIGZyb20gJy4uLy4uLy4uL2NvbXBvbmVudHMvTW9kYWwuanN4J1xuaW1wb3J0IEFkZEFzc2lnbm1lbnQgZnJvbSAnLi9idXR0b25zL0FkZEFzc2lnbm1lbnQuanN4J1xuaW1wb3J0IFRvZ2dsZUNsYXNzVmlldyBmcm9tICcuL2J1dHRvbnMvVG9nZ2xlQ2xhc3NWaWV3LmpzeCdcbmltcG9ydCBEZWxldGVDbGFzcyBmcm9tICcuL2J1dHRvbnMvRGVsZXRlQ2xhc3MuanN4J1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihwcm9wcylcbntcbiAgICBsZXQge3ZpZXcsIHRpdGxlLCBjbGFzc0lkLCBhc3NpZ25tZW50QXZlcmFnZXMsIGNsYXNzQXZlcmFnZSwgc3R1ZGVudHMsIHRvZ2dsZVZpZXcsIHRvZ2dsZU1vZGFsLCBzZXRDbGFzc2VzfSA9IHByb3BzXG4gICAgbGV0IGRlbGV0ZUNsYXNzID0gKCkgPT4gY29udHJvbGxlci5jbGFzcy5kZWxldGUoY2xhc3NJZClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oICgpID0+IHNldENsYXNzZXMoe2RhdGE6IHsnaWQnOiBjbGFzc0lkfX0pIClcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKCAoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoZXJyb3IpIClcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgbGV0IG1vZGFsID0gPE1vZGFsIHN1YmplY3Q9eydjbGFzcyd9IGRlbGV0ZVN1YmplY3Q9e2RlbGV0ZUNsYXNzfSBnb0JhY2s9eygpID0+IHRvZ2dsZU1vZGFsKCl9Lz5cblxuICAgIGxldCBudW1iZXJPZlN0dWRlbnRzID0gc3R1ZGVudHMubGVuZ3RoLFxuICAgICAgICBudW1iZXJPZkFzc2lnbm1lbnRzID0gT2JqZWN0LmtleXMoYXNzaWdubWVudEF2ZXJhZ2VzKS5sZW5ndGhcblxuICAgIGxldCBsaXN0TGVuZ3RoID0gdmlldyA9PT0gJ2Fzc2lnbm1lbnRzJyA/IFxuICAgICAgICAgICAgICAgICAgICBgTm8uIG9mIEFzc2lnbm1lbnRzOiAke251bWJlck9mQXNzaWdubWVudHN9YCA6XG4gICAgICAgICAgICAgICAgICAgIGBDbGFzcyBTaXplOiAke251bWJlck9mU3R1ZGVudHN9YFxuXG4gICAgcmV0dXJuIChcbiAgICAgICAgPGhlYWRlciBjbGFzc05hbWU9XCJjb250YWluZXItZmx1aWRcIj5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tkaXNwbGF5OidpbmxpbmUtYmxvY2snLCBoZWlnaHQ6JzQwcHgnfX0vPlxuICAgICAgICAgICAgPGRpdiBzdHlsZT17e3RleHRBbGlnbjogJ2NlbnRlcid9fT5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0bi1ncm91cCBkcm9wZW5kXCI+XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gc3R5bGU9e3tmb250U2l6ZTogJzNyZW0nfX0gdHlwZT1cImJ1dHRvblwiIGNsYXNzTmFtZT1cImJ0biBkcm9wZG93bi10b2dnbGVcIiBkYXRhLWJzLXRvZ2dsZT1cImRyb3Bkb3duXCIgYXJpYS1leHBhbmRlZD1cImZhbHNlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7dGl0bGV9XG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICA8dWwgY2xhc3NOYW1lPVwiZHJvcGRvd24tbWVudVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGxpPjxUb2dnbGVDbGFzc1ZpZXcgdmlldz17dmlld30gbnVtYmVyT2ZBc3NpZ25tZW50cz17bnVtYmVyT2ZBc3NpZ25tZW50c30gdG9nZ2xlVmlldz17dG9nZ2xlVmlld30vPjwvbGk+ICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICA8bGk+PEFkZEFzc2lnbm1lbnQgey4uLnByb3BzfSBkaXNhYmxlZD17Qm9vbGVhbihzdHVkZW50cy5sZW5ndGgpfS8+PC9saT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaT48aHIgY2xhc3NOYW1lPVwiZHJvcGRvd24tZGl2aWRlclwiLz48L2xpPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGxpPjxEZWxldGVDbGFzcyBzaG93TW9kYWw9eygpPT57dG9nZ2xlTW9kYWwobW9kYWwpfX0vPjwvbGk+XG4gICAgICAgICAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGgyPntsaXN0TGVuZ3RofTwvaDI+XG4gICAgICAgICAgICAgICAgPGgzIHN0eWxlPXt7Y29sb3I6JyM3NzcnfX0+QXZlcmFnZSBHcmFkZToge2NsYXNzQXZlcmFnZX08L2gzPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvaGVhZGVyPlxuICAgIClcbn0iLCJpbXBvcnQgUmVhY3QsIHsgbGF6eSwgdXNlU3RhdGUsIHVzZUVmZmVjdCwgU3VzcGVuc2UgfSBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IHsgQnJvd3NlclJvdXRlciBhcyBSb3V0ZXIsIFJvdXRlLCBMaW5rLCBTd2l0Y2ggfSBmcm9tIFwicmVhY3Qtcm91dGVyLWRvbVwiXG5pbXBvcnQgY29udHJvbGxlciBmcm9tIFwiLi4vLi4vY29udHJvbGxlci5qc1wiXG5pbXBvcnQgSGVhZGVyIGZyb20gXCIuL2hlYWRlci9pbmRleC5qc3hcIlxuY29uc3QgVmlld1N0dWRlbnRzID0gbGF6eSgoKSA9PiBpbXBvcnQoXCIuL3N0dWRlbnRzL2luZGV4LmpzeFwiKSlcbmNvbnN0IFZpZXdBc3NpZ25tZW50cyA9IGxhenkoKCkgPT4gaW1wb3J0KFwiLi9hc3NpZ25tZW50cy9pbmRleC5qc3hcIikpXG5jb25zdCBTdHVkZW50VmlldyA9IGxhenkoKCkgPT4gaW1wb3J0KFwiLi4vc3R1ZGVudC9pbmRleC5qc3hcIikpXG5jb25zdCBBc3NpZ25tZW50SW5wdXQgPSBsYXp5KCgpID0+IGltcG9ydChcIi4uL2Fzc2lnbm1lbnQvaW5kZXguanN4XCIpKVxuY29uc3QgTm90Rm91bmQgPSBsYXp5KCgpID0+IGltcG9ydChcIi4uLzQwNC9pbmRleC5qc3hcIikpXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHByb3BzKVxue1xuICBsZXQgeyBtYXRjaCwgdGl0bGUsIHRvZ2dsZU1vZGFsLCBzZXRDbGFzc2VzIH0gPSBwcm9wc1xuICBjb25zdCBkZWZhdWx0U3RhdGUgPSB7XG4gICAgbW91bnRlZDogZmFsc2UsXG4gICAgdmlldzogJ3N0dWRlbnRzJyxcbiAgICBzdHVkZW50czogW10sXG4gICAgc3R1ZGVudEF2ZXJhZ2VzOiB7fSxcbiAgICBhc3NpZ25tZW50czogW10sXG4gICAgYXNzaWdubWVudEF2ZXJhZ2VzOiB7fSxcbiAgICBjbGFzc0F2ZXJhZ2U6ICdDYWxjdWxhdGluZy4uLicsXG4gIH1cbiAgY29uc3QgWyBzdGF0ZSwgc2V0U3RhdGUgXSA9IHVzZVN0YXRlKHsuLi5kZWZhdWx0U3RhdGV9KSxcbiAgY2xhc3NJZCA9IG1hdGNoLnBhcmFtcy5jbGFzc0lkXG4gIGlmICh0aXRsZSA9PT0gbnVsbCkgdGl0bGUgPSAnTG9hZGluZy4uLidcblxuICB1c2VFZmZlY3QoICgpID0+IHtcbiAgICBpZiAoIXN0YXRlLm1vdW50ZWQpIHNldFN0YXRlKHsuLi5zdGF0ZSwgbW91bnRlZDogdHJ1ZX0pXG4gIH0sIFtzdGF0ZS5tb3VudGVkXSlcblxuICB1c2VFZmZlY3QoICgpID0+IHtcbiAgICBpZiAoc3RhdGUubW91bnRlZCAmJiBjbGFzc0lkICE9PSBcIiBcIikge1xuICAgICAgbG9hZFN0dWRlbnRzKClcbiAgICB9XG4gIH0sIFtjbGFzc0lkLCBzdGF0ZS5tb3VudGVkXSlcblxuICB1c2VFZmZlY3QoICgpID0+IHtcbiAgICBpZiAoc3RhdGUuc3R1ZGVudHMubGVuZ3RoKSB7XG4gICAgICBsb2FkQXNzaWdubWVudHMoKVxuICAgIH1cbiAgfSwgW3N0YXRlLnN0dWRlbnRzXSlcblxuICB1c2VFZmZlY3QoICgpID0+IHtcbiAgICBpZiAoc3RhdGUuYXNzaWdubWVudHMubGVuZ3RoKSBjYWxjdWxhdGVTdHVkZW50QXZlcmFnZXMoKVxuICB9LCBbc3RhdGUuYXNzaWdubWVudHNdKVxuXG4gIHVzZUVmZmVjdCggKCkgPT4ge1xuICAgIGlmIChPYmplY3Qua2V5cyhzdGF0ZS5zdHVkZW50QXZlcmFnZXMpLmxlbmd0aCkgY2FsY3VsYXRlQ2xhc3NBdmVyYWdlKClcbiAgfSwgW3N0YXRlLnN0dWRlbnRBdmVyYWdlc10pXG5cbiAgdXNlRWZmZWN0KCAoKSA9PiB7XG4gICAgaWYgKHN0YXRlLmNsYXNzQXZlcmFnZSAhPT0gJ0NhbGN1bGF0aW5nLi4uJykgY2FsY3VsYXRlQXNzaWdubWVudEF2ZXJhZ2VzKClcbiAgfSwgW3N0YXRlLmNsYXNzQXZlcmFnZV0pXG5cbiAgaWYgKHRpdGxlID09PSB1bmRlZmluZWQpIHJldHVybiA8Tm90Rm91bmQvPlxuXG5cbiAgZnVuY3Rpb24gbG9hZFN0dWRlbnRzKClcbiAge1xuICAgIGNvbnRyb2xsZXIuc3R1ZGVudC5sb2FkKGNsYXNzSWQpXG4gICAgLnRoZW4oKHtkYXRhfSkgPT4ge1xuICAgICAgc2V0U3RhdGUoe1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgdmlldzogJ3N0dWRlbnRzJyxcbiAgICAgICAgc3R1ZGVudHM6IGRhdGEsXG4gICAgICAgIGNsYXNzQXZlcmFnZTogZGF0YS5sZW5ndGggPyAnQ2FsY3VsYXRpbmcuLi4nIDogJ04vQSdcbiAgICAgIH0pXG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKGVycm9yKSlcbiAgfVxuXG4gIGZ1bmN0aW9uIGxvYWRBc3NpZ25tZW50cygpXG4gIHtcbiAgICBjb250cm9sbGVyLmFzc2lnbm1lbnQubG9hZChjbGFzc0lkKVxuICAgIC50aGVuKCh7ZGF0YX0pID0+IHtcbiAgICAgIHNldFN0YXRlKHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGFzc2lnbm1lbnRzOiBkYXRhLFxuICAgICAgICBjbGFzc0F2ZXJhZ2U6ICFkYXRhLmxlbmd0aCA/ICdOL0EnIDogJ0NhbGN1bGF0aW5nLi4uJ1xuICAgICAgfSlcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoZXJyb3IpKVxuXG4gIH1cblxuICBcbiAgZnVuY3Rpb24gY2FsY3VsYXRlU3R1ZGVudEF2ZXJhZ2VzKClcbiAge1xuICAgIGxldCBzdHVkZW50QXZlcmFnZXMgPSB7fVxuICAgIGxldCBhc3NpZ25tZW50cyA9IFsuLi5zdGF0ZS5hc3NpZ25tZW50c11cbiAgICBzdGF0ZS5zdHVkZW50cy5mb3JFYWNoKCAoc3R1ZGVudCkgPT4ge1xuICAgICAgbGV0IHRvdGFsUG9pbnRzU2NvcmVkID0gMFxuICAgICAgbGV0IHRvdGFsUG9pbnRzUG9zc2libGUgPSAwXG4gICAgICBcbiAgICAgIGFzc2lnbm1lbnRzID0gYXNzaWdubWVudHMuZmlsdGVyKChhc3NpZ25tZW50KSA9PiB7XG4gICAgICAgIGlmIChhc3NpZ25tZW50LnN0dWRlbnRfaWQgIT0gc3R1ZGVudC5pZCkgcmV0dXJuIHRydWVcbiAgICAgICAgaWYgKCFpc05hTihhc3NpZ25tZW50LnNjb3JlKSkgdG90YWxQb2ludHNTY29yZWQgKz0gcGFyc2VJbnQoYXNzaWdubWVudC5zY29yZSlcbiAgICAgICAgdG90YWxQb2ludHNQb3NzaWJsZSArPSBwYXJzZUludChhc3NpZ25tZW50LnRvdGFscG9pbnRzKVxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH0pXG5cbiAgICAgIGxldCBhdmVyYWdlID0gdG90YWxQb2ludHNQb3NzaWJsZSAhPT0gMCA/ICh0b3RhbFBvaW50c1Njb3JlZCAvIHRvdGFsUG9pbnRzUG9zc2libGUgKiAxMDApLnRvRml4ZWQoMikgOiAnTi9BJyBcblxuICAgICAgc3R1ZGVudEF2ZXJhZ2VzW3N0dWRlbnQuaWRdID0gYXZlcmFnZVxuICAgIH0pXG5cbiAgICBzZXRTdGF0ZSh7Li4uc3RhdGUsc3R1ZGVudEF2ZXJhZ2VzfSlcbiAgfVxuXG4gIFxuICBmdW5jdGlvbiBjYWxjdWxhdGVDbGFzc0F2ZXJhZ2UoKSB7XG4gICAgdmFyIHRvdGFsUGVyY2VudGFnZSA9IDBcbiAgICB2YXIgbnVtYmVyT2ZQZXJjZW50YWdlcyA9IDBcbiAgXG4gICAgZm9yKGxldCBzdHVkZW50QXZlcmFnZSBpbiBzdGF0ZS5zdHVkZW50QXZlcmFnZXMpIHtcbiAgICAgIGlmIChzdGF0ZS5zdHVkZW50QXZlcmFnZXNbc3R1ZGVudEF2ZXJhZ2VdICE9PSAnTi9BJykge1xuICAgICAgICB0b3RhbFBlcmNlbnRhZ2UgKz0gcGFyc2VGbG9hdChzdGF0ZS5zdHVkZW50QXZlcmFnZXNbc3R1ZGVudEF2ZXJhZ2VdKVxuICAgICAgICArK251bWJlck9mUGVyY2VudGFnZXNcbiAgICAgIH1cbiAgICB9XG4gIFxuICAgIGlmICghbnVtYmVyT2ZQZXJjZW50YWdlcykge1xuICAgICAgdG90YWxQZXJjZW50YWdlID0gJ04vQSdcbiAgICB9IGVsc2UgaWYgKGlzTmFOKHRvdGFsUGVyY2VudGFnZSAvIG51bWJlck9mUGVyY2VudGFnZXMpKSByZXR1cm4gZmFsc2VcbiAgICBcbiAgICB0b3RhbFBlcmNlbnRhZ2UgPSAodG90YWxQZXJjZW50YWdlIC8gbnVtYmVyT2ZQZXJjZW50YWdlcykudG9GaXhlZCgyKSArICclJ1xuICBcbiAgICBzZXRTdGF0ZSh7Li4uc3RhdGUsY2xhc3NBdmVyYWdlOiB0b3RhbFBlcmNlbnRhZ2V9KVxuICB9XG5cbiAgZnVuY3Rpb24gY2FsY3VsYXRlQXNzaWdubWVudEF2ZXJhZ2VzKClcbiAge1xuICAgIGxldCBhc3NpZ25tZW50cyA9IHt9XG4gICAgLy8gc2FtZSBhc3NpZ25tZW50IGZvciBlYWNoIHN0dWRlbnQsIG5lZWQgdG8gc2VsZWN0IHNhbWUgYXNzaWdubWVudFxuICAgIHN0YXRlLmFzc2lnbm1lbnRzLmZvckVhY2goYXNzaWdubWVudCA9PiB7XG4gICAgICBhc3NpZ25tZW50c1thc3NpZ25tZW50LnRpdGxlXSA9IHRydWVcbiAgICB9KVxuXG4gICAgT2JqZWN0LmtleXMoYXNzaWdubWVudHMpLmZvckVhY2godGl0bGUgPT4ge1xuICAgICAgbGV0IGdpdmVuQXNzaWdubWVudCA9IHN0YXRlLmFzc2lnbm1lbnRzLmZpbHRlcihhc3NpZ25tZW50ID0+IGFzc2lnbm1lbnQudGl0bGUgPT09IHRpdGxlKVxuICAgICAgbGV0IHRvdGFsUG9pbnRzID0gMFxuICAgICAgbGV0IHNjb3JlZFBvaW50cyA9IDBcblxuICAgICAgZ2l2ZW5Bc3NpZ25tZW50LmZvckVhY2goYXNzaWdubWVudCA9PiB7XG4gICAgICAgIHRvdGFsUG9pbnRzICs9IHBhcnNlSW50KGFzc2lnbm1lbnQudG90YWxwb2ludHMpXG4gICAgICAgIHNjb3JlZFBvaW50cyArPSBwYXJzZUludChhc3NpZ25tZW50LnNjb3JlKVxuICAgICAgfSlcbiAgICAgIGFzc2lnbm1lbnRzW3RpdGxlXSA9IChzY29yZWRQb2ludHMvdG90YWxQb2ludHMgKiAxMDApLnRvRml4ZWQoMikgKyAnJSdcbiAgICB9KVxuXG4gICAgc2V0U3RhdGUoey4uLnN0YXRlLGFzc2lnbm1lbnRBdmVyYWdlczogYXNzaWdubWVudHN9KVxuICB9XG5cblxuICBmdW5jdGlvbiBzb3J0QnlOYW1lKClcbiAge1xuICAgIGxldCBzdHVkZW50cyA9IFsuLi5zdGF0ZS5zdHVkZW50c11cbiAgICBcbiAgICBsZXQgYmVmb3JlU29ydCA9IEpTT04uc3RyaW5naWZ5KHtzdHVkZW50c30pXG4gICAgc3R1ZGVudHMuc29ydCgoYSxiKSA9PiBhLm5hbWUudG9Mb3dlckNhc2UoKSA+IGIubmFtZS50b0xvd2VyQ2FzZSgpKVxuICAgIGxldCBhZnRlclNvcnQgPSBKU09OLnN0cmluZ2lmeSh7c3R1ZGVudHN9KVxuICAgIGlmIChiZWZvcmVTb3J0ID09PSBhZnRlclNvcnQpXG4gICAgc3R1ZGVudHMuc29ydCgoYSxiKSA9PiBhLm5hbWUudG9Mb3dlckNhc2UoKSA8IGIubmFtZS50b0xvd2VyQ2FzZSgpKVxuXG4gICAgc2V0U3RhdGUoey4uLnN0YXRlLCBzdHVkZW50c30pXG4gIH1cblxuXG4gIGZ1bmN0aW9uIHNvcnRCeUdyYWRlKClcbiAge1xuICAgIGxldCBzdHVkZW50cyA9IFsuLi5zdGF0ZS5zdHVkZW50c11cbiAgICBsZXQgYmVmb3JlU29ydCA9IEpTT04uc3RyaW5naWZ5KHtzdHVkZW50c30pXG4gICAgc3R1ZGVudHMuc29ydCgoYSxiKSA9PiB7XG4gICAgICBpZiAoaXNOYU4ocGFyc2VGbG9hdChzdGF0ZS5zdHVkZW50QXZlcmFnZXNbYS5pZF0pKSkgcmV0dXJuIGZhbHNlXG4gICAgICBpZiAoaXNOYU4ocGFyc2VGbG9hdChzdGF0ZS5zdHVkZW50QXZlcmFnZXNbYi5pZF0pKSkgcmV0dXJuIHRydWVcbiAgICAgIHJldHVybiBwYXJzZUZsb2F0KHN0YXRlLnN0dWRlbnRBdmVyYWdlc1thLmlkXSkgPiBwYXJzZUZsb2F0KHN0YXRlLnN0dWRlbnRBdmVyYWdlc1tiLmlkXSlcbiAgICB9KVxuICAgIGxldCBhZnRlclNvcnQgPSBKU09OLnN0cmluZ2lmeSh7c3R1ZGVudHN9KVxuXG4gICAgaWYgKGJlZm9yZVNvcnQgPT09IGFmdGVyU29ydClcbiAgICBzdHVkZW50cy5zb3J0KChhLGIpID0+IHtcbiAgICAgIGlmIChpc05hTihwYXJzZUZsb2F0KHN0YXRlLnN0dWRlbnRBdmVyYWdlc1tiLmlkXSkpKSByZXR1cm4gZmFsc2VcbiAgICAgIGlmIChpc05hTihwYXJzZUZsb2F0KHN0YXRlLnN0dWRlbnRBdmVyYWdlc1thLmlkXSkpKSByZXR1cm4gdHJ1ZVxuICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoc3RhdGUuc3R1ZGVudEF2ZXJhZ2VzW2EuaWRdKSA8IHBhcnNlRmxvYXQoc3RhdGUuc3R1ZGVudEF2ZXJhZ2VzW2IuaWRdKVxuICAgIH0pXG4gICAgc2V0U3RhdGUoey4uLnN0YXRlLCBzdHVkZW50c30pXG4gIH1cblxuICBmdW5jdGlvbiB0b2dnbGVWaWV3KClcbiAge1xuICAgIGlmIChzdGF0ZS52aWV3ID09PSAnYXNzaWdubWVudHMnKSByZXR1cm4gc2V0U3RhdGUoey4uLnN0YXRlLCB2aWV3OidzdHVkZW50cyd9KVxuICAgIHNldFN0YXRlKHsuLi5zdGF0ZSwgdmlldzonYXNzaWdubWVudHMnfSlcbiAgICBcbiAgfVxuXG4gIGZ1bmN0aW9uIGRlbGV0ZVN0dWRlbnRDYWxsYmFjayhzdHVkZW50SWQpXG4gIHtcbiAgICBjb25zdCBzdHVkZW50cyA9IHN0YXRlLnN0dWRlbnRzLmZpbHRlcihzdHVkZW50ID0+IHN0dWRlbnQuaWQgIT09IHN0dWRlbnRJZClcbiAgICBzZXRTdGF0ZSh7Li4uc3RhdGUsIHN0dWRlbnRzfSlcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZFN0dWRlbnRDYWxsYmFjayhkYXRhLCBuYW1lKVxuICB7XG4gICAgY29uc3QgbmV3U3R1ZGVudE9iaiA9IHsnaWQnOiBkYXRhLmluc2VydElkLCBuYW1lIH1cbiAgICBjb25zdCBzdHVkZW50cyA9IFsuLi5zdGF0ZS5zdHVkZW50c11cbiAgICBzdHVkZW50cy5wdXNoKG5ld1N0dWRlbnRPYmopXG4gICAgc2V0U3RhdGUoey4uLnN0YXRlLHN0dWRlbnRzfSlcbiAgfVxuICByZXR1cm4gKFxuICAgIDxTd2l0Y2g+XG4gICAgICA8Um91dGUgZXhhY3QgcGF0aD17YC8ke2NsYXNzSWR9YH0gcmVuZGVyPXsocHJvcHMpID0+IFxuICAgICAgICAgIDw+XG4gICAgICAgICAgICA8SGVhZGVyIHsuLi5wcm9wc30gdmlldz17c3RhdGUudmlld30gdGl0bGU9e3RpdGxlfSBjbGFzc0lkPXtjbGFzc0lkfSBhc3NpZ25tZW50QXZlcmFnZXM9e3N0YXRlLmFzc2lnbm1lbnRBdmVyYWdlc30gY2xhc3NBdmVyYWdlPXtzdGF0ZS5jbGFzc0F2ZXJhZ2V9IHN0dWRlbnRzPXtzdGF0ZS5zdHVkZW50c30gc2V0Q2xhc3Nlcz17c2V0Q2xhc3Nlc30gdG9nZ2xlVmlldz17dG9nZ2xlVmlld30gdG9nZ2xlTW9kYWw9e3RvZ2dsZU1vZGFsfS8+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHN0YXRlLnZpZXcgPT09ICdzdHVkZW50cycgP1xuICAgICAgICAgICAgICA8U3VzcGVuc2UgZmFsbGJhY2s9ezxkaXY+TG9hZGluZy4uLjwvZGl2Pn0+XG4gICAgICAgICAgICAgICAgPFZpZXdTdHVkZW50cyB7Li4ucHJvcHN9IGNsYXNzSWQ9e2NsYXNzSWR9IHN0dWRlbnRzPXtzdGF0ZS5zdHVkZW50c30gYXNzaWdubWVudHM9e3N0YXRlLmFzc2lnbm1lbnRzfSBhdmVyYWdlcz17c3RhdGUuc3R1ZGVudEF2ZXJhZ2VzfSB0b2dnbGVNb2RhbD17dG9nZ2xlTW9kYWx9IGFkZFN0dWRlbnRDYWxsYmFjaz17YWRkU3R1ZGVudENhbGxiYWNrfSBkZWxldGVTdHVkZW50Q2FsbGJhY2s9e2RlbGV0ZVN0dWRlbnRDYWxsYmFja30gc29ydD17e3NvcnRCeU5hbWUsIHNvcnRCeUdyYWRlfX0vPlxuICAgICAgICAgICAgICA8L1N1c3BlbnNlPiA6XG4gICAgICAgICAgICAgIDxTdXNwZW5zZSBmYWxsYmFjaz17PGRpdj5Mb2FkaW5nLi4uPC9kaXY+fT5cbiAgICAgICAgICAgICAgICA8Vmlld0Fzc2lnbm1lbnRzIHsuLi5wcm9wc30gYXNzaWdubWVudHM9e3N0YXRlLmFzc2lnbm1lbnRzfSBhdmVyYWdlcz17c3RhdGUuYXNzaWdubWVudEF2ZXJhZ2VzfS8+XG4gICAgICAgICAgICAgIDwvU3VzcGVuc2U+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgPC8+XG4gICAgICB9IC8+XG4gICAgICA8Um91dGUgZXhhY3QgcGF0aD17YC8ke2NsYXNzSWR9L2Fzc2lnbm1lbnRgfSByZW5kZXI9eyhwcm9wcykgPT5cbiAgICAgICAgICA8U3VzcGVuc2UgZmFsbGJhY2s9ezxkaXY+TG9hZGluZy4uLjwvZGl2Pn0+XG4gICAgICAgICAgICA8QXNzaWdubWVudElucHV0IHsuLi5wcm9wc30gYXNzaWdubWVudHM9e3N0YXRlLmFzc2lnbm1lbnRzfSBsb2FkQXNzaWdubWVudHM9e2xvYWRBc3NpZ25tZW50c30gc3R1ZGVudHM9e3N0YXRlLnN0dWRlbnRzfSBzdHVkZW50QXZlcmFnZXM9e3N0YXRlLnN0dWRlbnRBdmVyYWdlc30gY2xhc3NBdmVyYWdlPXtzdGF0ZS5jbGFzc0F2ZXJhZ2V9IGNsYXNzSWQ9e2NsYXNzSWR9IHRpdGxlPXt0aXRsZX0vPlxuICAgICAgICAgIDwvU3VzcGVuc2U+fVxuICAgICAgLz5cbiAgICAgIDxSb3V0ZSBwYXRoPXtgLyR7Y2xhc3NJZH0vOnN0dWRlbnRJZGB9IHJlbmRlcj17KHByb3BzKSA9PlxuICAgICAgICAgIDxTdXNwZW5zZSBmYWxsYmFjaz17PGRpdj5Mb2FkaW5nLi4uPC9kaXY+fT5cbiAgICAgICAgICAgIDxTdHVkZW50VmlldyB7Li4ucHJvcHN9IHN0dWRlbnRzPXtzdGF0ZS5zdHVkZW50c30gY2xhc3NJZD17Y2xhc3NJZH0gdGl0bGU9e3RpdGxlfSBsb2FkQXNzaWdubWVudHM9e2xvYWRBc3NpZ25tZW50c30gc3R1ZGVudEF2ZXJhZ2U9e3N0YXRlLnN0dWRlbnRBdmVyYWdlc1twcm9wcy5tYXRjaC5wYXJhbXMuc3R1ZGVudElkXX0gYXNzaWdubWVudHM9e3N0YXRlLmFzc2lnbm1lbnRzLmZpbHRlcihhc3NpZ25tZW50ID0+IGFzc2lnbm1lbnQuc3R1ZGVudF9pZCA9PSBwcm9wcy5tYXRjaC5wYXJhbXMuc3R1ZGVudElkKX0gLz5cbiAgICAgICAgICA8L1N1c3BlbnNlPn1cbiAgICAgIC8+XG4gICAgPC9Td2l0Y2g+XG4gIClcbn0iXSwibmFtZXMiOlsicHJvcHMiLCJzdWJqZWN0IiwiZGVsZXRlU3ViamVjdCIsImdvQmFjayIsInN0eWxlIiwiZGlzcGxheSIsImNsYXNzTmFtZSIsInRhYkluZGV4Iiwicm9sZSIsImF1dG9Gb2N1cyIsInR5cGUiLCJvbkNsaWNrIiwibWF0Y2giLCJkaXNhYmxlZCIsInRvIiwidXJsIiwibnVtYmVyT2ZBc3NpZ25tZW50cyIsInZpZXciLCJ0b2dnbGVWaWV3IiwidGV4dCIsInNob3dNb2RhbCIsImNvbG9yIiwidGl0bGUiLCJjbGFzc0lkIiwiYXNzaWdubWVudEF2ZXJhZ2VzIiwiY2xhc3NBdmVyYWdlIiwic3R1ZGVudHMiLCJ0b2dnbGVNb2RhbCIsInNldENsYXNzZXMiLCJtb2RhbCIsIk1vZGFsIiwiY29udHJvbGxlciIsInRoZW4iLCJkYXRhIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJudW1iZXJPZlN0dWRlbnRzIiwibGVuZ3RoIiwiT2JqZWN0Iiwia2V5cyIsImxpc3RMZW5ndGgiLCJoZWlnaHQiLCJ0ZXh0QWxpZ24iLCJmb250U2l6ZSIsIlRvZ2dsZUNsYXNzVmlldyIsIkFkZEFzc2lnbm1lbnQiLCJCb29sZWFuIiwiRGVsZXRlQ2xhc3MiLCJWaWV3U3R1ZGVudHMiLCJsYXp5IiwiVmlld0Fzc2lnbm1lbnRzIiwiU3R1ZGVudFZpZXciLCJBc3NpZ25tZW50SW5wdXQiLCJOb3RGb3VuZCIsInN0YXRlIiwic2V0U3RhdGUiLCJ1c2VTdGF0ZSIsIm1vdW50ZWQiLCJzdHVkZW50QXZlcmFnZXMiLCJhc3NpZ25tZW50cyIsInBhcmFtcyIsInVzZUVmZmVjdCIsImxvYWRBc3NpZ25tZW50cyIsImZvckVhY2giLCJzdHVkZW50IiwidG90YWxQb2ludHNTY29yZWQiLCJ0b3RhbFBvaW50c1Bvc3NpYmxlIiwiZmlsdGVyIiwiYXNzaWdubWVudCIsInN0dWRlbnRfaWQiLCJpZCIsImlzTmFOIiwic2NvcmUiLCJwYXJzZUludCIsInRvdGFscG9pbnRzIiwiYXZlcmFnZSIsInRvRml4ZWQiLCJjYWxjdWxhdGVTdHVkZW50QXZlcmFnZXMiLCJ0b3RhbFBlcmNlbnRhZ2UiLCJudW1iZXJPZlBlcmNlbnRhZ2VzIiwic3R1ZGVudEF2ZXJhZ2UiLCJwYXJzZUZsb2F0IiwiY2FsY3VsYXRlQ2xhc3NBdmVyYWdlIiwiZ2l2ZW5Bc3NpZ25tZW50IiwidG90YWxQb2ludHMiLCJzY29yZWRQb2ludHMiLCJjYWxjdWxhdGVBc3NpZ25tZW50QXZlcmFnZXMiLCJ1bmRlZmluZWQiLCJzb3J0QnlOYW1lIiwiYmVmb3JlU29ydCIsIkpTT04iLCJzdHJpbmdpZnkiLCJzb3J0IiwiYSIsImIiLCJuYW1lIiwidG9Mb3dlckNhc2UiLCJzb3J0QnlHcmFkZSIsImRlbGV0ZVN0dWRlbnRDYWxsYmFjayIsInN0dWRlbnRJZCIsImFkZFN0dWRlbnRDYWxsYmFjayIsIm5ld1N0dWRlbnRPYmoiLCJpbnNlcnRJZCIsInB1c2giLCJleGFjdCIsInBhdGgiLCJyZW5kZXIiLCJTdXNwZW5zZSIsImZhbGxiYWNrIiwiYXZlcmFnZXMiXSwic291cmNlUm9vdCI6IiJ9